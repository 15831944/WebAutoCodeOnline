<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>
    <meta name="description" content="C# Demo大全 单个项目预览" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="我要调试,51调试,51debug,C#在线代码生成器" name="Keywords" />
    <meta name="description" content="51debug是程序员的好助手，帮助各种程序员进行快速开发，提高开发效率和分享代码库" />
    <title>我要调试 - C# Demo大全</title>

    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="../js/bootstrap-3.3.0-dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- 可选的Bootstrap主题文件（一般不使用） -->
    <link href="../js/bootstrap-3.3.0-dist/css/bootstrap-theme.min.css" rel="stylesheet" />

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="../js/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="../js/bootstrap-3.3.0-dist/js/bootstrap.min.js"></script>

    <!-- 初始化界面js -->
    <script src="../js/load.js?20161108_2"></script>
</head>
<body>
    <!-- 导航 -->
    <div id="nav"></div>

    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <h2>代码预览</h2>
                <ul id="browser" class="filetree small">
                </ul>
            </div>
            <div id="demodiv" class="col-md-9">
                <textarea id="rightcp_txtCode" name="rightcp_txtCode" class="form-control csharp" rows="10">
                </textarea>
            </div>
        </div>
    </div>
    <link href="../js/codehighlight/SyntaxHighlighter.css" rel="stylesheet" />
    <script src="../js/codehighlight/shCore.js"></script>
    <script src="../js/codehighlight/shBrushCSharp.js"></script>
    <link href="../js/jquery-treeview/jquery.treeview.css" rel="stylesheet" />
    <script src="../js/jquery-treeview/jquery.treeview.js"></script>
    <!-- SyntaxHighlighter CSS and JavaScript -->
    <script type="text/javascript">
        $(document).ready(function () {
            loaddata();
            dp.SyntaxHighlighter.HighlightAll('rightcp_txtCode');
        });

        function readfile(key, id) {
            // post读取文件内容赋值到textarea
            $.post("../Api.ashx?type=loaddemo", { "key": key, "id": id }, function (data) {
                $("#demodiv").empty();
                $("#demodiv").html("<textarea id=\"rightcp_txtCode\" name=\"rightcp_txtCode\" class=\"form-control csharp\" rows=\"10\"></textarea>");
                $("#rightcp_txtCode").text(data.Result);
                dp.SyntaxHighlighter.HighlightAll('rightcp_txtCode'); 
                //dp.SyntaxHighlighter.Highlighter();
            }, 'json');
        }

        function loaddata() {
            var url = document.location.href;
            var index = url.indexOf("?");
            var key = url.substring(index + 1, url.length);
            $.post("../Api.ashx?type=loaddemo", { "key": key }, function (data) {
                $('#browser').empty().append(createtree(data, key));
                // 显示内容
                $("#browser").treeview();
            }, 'json');
        }

        function createtree(d, key) {
            var list = '';
            $.each(d, function (i, n) {
                var cls = 'folder';
                if (n.children.length == 0)
                    cls = 'file';

                list += '<li><span class="' + cls + '" ref="' + n.id + '"  pid="' + n.parentid + '" id="' + n.id + '" ><a href="javascript:readfile(\'' + key + '\',' + n.id + ');">' + n.text + '</a></span>';
                if (n.children.length > 0) {
                    list += "<ul>";
                    list += createtree(n.children, key);
                    list += "</ul>"
                }

                list += "</li>";
            });
            return list;
        }
    </script>

    <!-- 站点地图&友情链接 -->
    <div id="sitemap"></div>

    <!-- Fotter -->
    <div id="fotter"></div>
</body>
</html>
